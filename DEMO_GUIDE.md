# 快速演示指南

## 1. 启动应用

应用已经在运行中！如果需要重新启动：

```bash
python main.py
```

## 2. 导入示例数据

项目已经创建了示例 Excel 文件 `sample_students.xlsx`，包含 8 名学生：

- Alice (ID: 2024001, Weight: 1.0)
- Bob (ID: 2024002, Weight: 1.0)
- Charlie (ID: 2024003, Weight: 1.5)
- David (ID: 2024004, Weight: 1.0)
- Eve (ID: 2024005, Weight: 0.8)
- Frank (ID: 2024006, Weight: 1.0)
- Grace (ID: 2024007, Weight: 1.2)
- Henry (ID: 2024008, Weight: 1.0)

### 导入步骤：

1. 点击应用界面上的 "Import Excel" 按钮
2. 选择 `sample_students.xlsx` 文件
3. 等待导入完成

## 3. 测试抽取功能

### 测试 1：随机抽取

1. 抽取规则选择 "Random"
2. 抽取人数输入 "1"
3. 点击 "Start Pick" 按钮
4. 观察动画效果和结果显示

### 测试 2：权重抽取

1. 抽取规则选择 "Weighted"
2. 抽取人数输入 "1"
3. 多次点击 "Start Pick"
4. 注意 Charlie (weight=1.5) 和 Grace (weight=1.2) 被抽中的频率较高

### 测试 3：最少抽取

1. 抽取规则选择 "Least Picked"
2. 抽取人数输入 "1"
3. 多次点击 "Start Pick"
4. 观察所有学生被抽中次数趋于平衡

### 测试 4：排除已抽取

1. 先点击 "Reset Records" 重置所有记录
2. 抽取规则选择 "Random"
3. 勾选 "Exclude Picked"
4. 抽取人数输入 "1"
5. 连续点击 8 次 "Start Pick"
6. 观察每个学生只会被抽中一次

## 4. 测试管理功能

### 添加学生

1. 点击 "Add Student" 按钮
2. 填写姓名、学号（可选）、权重（可选）
3. 点击 "Add" 保存

### 编辑学生

1. 找到某个学生卡片
2. 点击卡片上的编辑按钮（铅笔图标）
3. 修改信息
4. 点击 "Save" 保存

### 删除学生

1. 找到某个学生卡片
2. 点击卡片上的删除按钮（垃圾桶图标）
3. 确认删除

### 查看统计

- 右侧统计面板实时显示：
  - Total: 总人数
  - Picked: 已抽取人数
  - Unpicked: 未抽取人数
  - Total Picks: 总抽取次数

## 5. 测试导出功能

1. 点击 "Export Excel" 按钮
2. 文件会自动保存到桌面，文件名为 `students.xlsx`
3. 打开文件查看，包含所有学生信息和抽取统计

## 6. 测试数据持久化

1. 关闭应用
2. 重新运行 `python main.py`
3. 观察之前的数据和统计信息都被保留

数据保存位置：

- Windows: `C:\Users\<用户名>\.conter\data.json`
- macOS/Linux: `~/.conter/data.json`

## 7. 观察动画效果

点名过程中注意观察：

1. 开始点名时的旋转图标
2. 名字快速切换的动画（20 帧）
3. 结果显示的缩放和淡入效果
4. 卡片的悬停效果

## 8. 测试错误处理

### 测试空名单点名

1. 点击右上角的垃圾桶图标清空所有数据
2. 尝试点击 "Start Pick"
3. 观察错误提示

### 测试无效的排除选项

1. 导入学生
2. 多次随机抽取直到所有学生都被抽中
3. 选择 "Random"，勾选 "Exclude Picked"
4. 点击 "Start Pick"
5. 观察提示信息

## 9. Web 模式测试

关闭桌面应用，然后运行：

```bash
flet run --web main.py
```

浏览器会自动打开，测试所有功能在 Web 模式下的表现。

## 10. 性能测试

### 测试大量数据

1. 准备一个包含 100+学生的 Excel 文件
2. 导入测试
3. 测试抽取速度和界面响应

## 常见问题

### Q: 应用窗口太小？

A: 拖动窗口边缘调整大小，最小尺寸为 1000x700

### Q: 找不到导入的文件？

A: 确保文件格式为.xlsx 或.xls，且第一列包含姓名

### Q: 权重抽取效果不明显？

A: 设置更大的权重差异，比如 0.5 和 3.0

### Q: 如何备份数据？

A: 复制 `~/.conter/data.json` 文件或使用导出 Excel 功能

## 演示脚本

如果要演示给他人看，建议按以下流程：

1. 启动应用，展示界面设计
2. 导入示例 Excel 文件
3. 展示学生列表和统计面板
4. 演示随机抽取功能和动画
5. 展示编辑学生信息
6. 演示权重抽取，说明权重的作用
7. 演示最少抽取，说明公平性
8. 展示排除已抽取功能
9. 演示导出 Excel 功能
10. 重启应用展示数据持久化

---

**享受点名的乐趣！** 🎉
