# 点名器使用指南

## 快速开始

### 1. 安装依赖

首次使用前，请确保已安装 Python 3.8 或更高版本，然后运行：

```bash
pip install -r requirements.txt
```

### 2. 运行应用

#### Windows 用户

双击运行 `run.bat` 文件，或在命令行中执行：

```bash
python main.py
```

#### Linux/macOS 用户

```bash
chmod +x run.sh
./run.sh
```

或直接运行：

```bash
python main.py
```

#### 作为 Web 应用运行

```bash
flet run --web main.py
```

## 功能详解

### 📥 导入名单

1. **Excel 导入**

   - 点击"导入 Excel"按钮
   - 选择包含学生名单的 Excel 文件
   - 支持格式：`.xlsx`, `.xls`
   - Excel 格式要求详见 `EXCEL_FORMAT.md`

2. **手动添加**
   - 点击"添加学生"按钮
   - 填写姓名（必填）
   - 填写学号（可选）
   - 设置权重（可选，默认 1.0）

### 🎲 抽取规则

应用支持三种抽取规则：

1. **随机抽取**

   - 完全随机，每个学生被抽中概率相等
   - 可选"排除已抽取"：只从未被抽取过的学生中选择

2. **权重抽取**

   - 根据每个学生的权重值决定被抽中概率
   - 权重越高，被抽中概率越大
   - 适合需要照顾某些学生的场景

3. **最少抽取**
   - 优先抽取被点名次数最少的学生
   - 确保每个学生被抽取的机会相对均等

### ⚙️ 抽取设置

- **抽取人数**：一次抽取多少个学生（默认 1 人）
- **排除已抽取**：仅在"随机抽取"模式下可用，勾选后只从未被抽取的学生中选择

### 📊 统计信息

右侧统计面板实时显示：

- 总人数
- 已抽取人数
- 未抽取人数
- 总抽取次数

### 🔄 数据管理

1. **编辑学生**

   - 点击学生卡片上的"编辑"按钮
   - 修改姓名、学号或权重

2. **删除学生**

   - 点击学生卡片上的"删除"按钮
   - 确认删除操作

3. **重置记录**

   - 点击"重置记录"按钮
   - 清空所有学生的抽取次数和历史记录
   - 学生信息保留

4. **清空数据**

   - 点击右上角的垃圾桶图标
   - 删除所有学生数据
   - ⚠️ 此操作不可恢复

5. **导出 Excel**
   - 点击"导出 Excel"按钮
   - 导出包含完整信息的 Excel 文件到桌面
   - 包含：姓名、学号、权重、被抽取次数、最后抽取时间

## 💡 使用技巧

### 权重设置建议

- 默认权重：1.0
- 提高被抽中概率：设置为 1.5、2.0 等
- 降低被抽中概率：设置为 0.5、0.8 等
- 权重值必须大于 0

### 使用场景

1. **课堂提问**

   - 使用"随机抽取"或"最少抽取"
   - 确保每个学生都有机会

2. **作业检查**

   - 使用"权重抽取"
   - 对需要重点关注的学生设置较高权重

3. **分组活动**

   - 设置抽取人数为组员数量
   - 多次抽取完成分组

4. **考勤检查**
   - 使用"排除已抽取"功能
   - 避免重复抽取同一学生

## 🎨 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────────────┐
│ 点名器    [导入] [导出] [添加] [重置] [清空]        │
├─────────────────────────────────────────────────────┤
│                                                      │
│  ┌─────────────────────┐  ┌──────────────────────┐ │
│  │ 抽取设置             │  │ 统计信息              │ │
│  │ [规则] [人数] [选项] │  │ • 总人数             │ │
│  │     [开始点名]       │  │ • 已抽取             │ │
│  ├─────────────────────┤  │ • 未抽取             │ │
│  │ 抽取结果             │  │ • 总抽取次数         │ │
│  │                      │  └──────────────────────┘ │
│  │   [显示抽取结果]     │                            │
│  └─────────────────────┘                            │
│                                                      │
│  学生列表                                            │
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐                       │
│  │学生│ │学生│ │学生│ │学生│ ...                    │
│  └────┘ └────┘ └────┘ └────┘                       │
│                                                      │
└─────────────────────────────────────────────────────┘
```

### 动画效果

- 点名时会显示流畅的切换动画
- 结果以弹跳动画呈现
- 增强使用体验和趣味性

## 📱 多平台支持

Flet 框架支持以下平台：

- ✅ Windows
- ✅ macOS
- ✅ Linux
- ✅ Web 浏览器
- ✅ iOS (需要额外配置)
- ✅ Android (需要额外配置)

## 💾 数据存储

- 数据自动保存在用户目录下的 `.conter` 文件夹
- Windows: `C:\Users\<用户名>\.conter\data.json`
- macOS/Linux: `~/.conter/data.json`
- JSON 格式，易于备份和迁移

## ⚠️ 注意事项

1. **导入 Excel 前建议备份**：确保数据安全
2. **权重值必须为正数**：否则默认为 1.0
3. **清空数据不可恢复**：操作前请确认
4. **大量数据建议分批导入**：提高性能

## 🔧 故障排除

### 问题：无法导入 Excel 文件

- 检查文件格式是否为 `.xlsx` 或 `.xls`
- 确保第一列包含姓名数据
- 尝试用 Excel 重新保存文件

### 问题：界面显示异常

- 尝试调整窗口大小
- 重启应用

### 问题：点名无反应

- 确保已添加学生
- 检查抽取人数设置是否合理
- 如果勾选了"排除已抽取"，确保还有未抽取的学生

## 📞 技术支持

如有问题或建议，欢迎反馈！

---

享受点名的乐趣！🎉
